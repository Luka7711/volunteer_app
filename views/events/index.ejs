<%- include ../partials/header.ejs %>
<h1>All Upcoming events</h1>
<nav>
  <ul>
    <li>
      <a href="/events/new">Create New Event</a>
    </li>

    <li>
      <a href="/users">Home</a>
    </li>

  </ul>

</nav>


<% for (let i = 0; i < event.length; i++) {%>
	<div class="indexEvents"><h3><%= event[i].title%></h3>
	<p>When: <%= event[i].date.toDateString() %></p>
	<p>What Time: <%= event[i].date.getHours()%>:<%= event[i].date.getMinutes()%> </p>
	<p>Description: <%=event[i].description %></p>
	<p>Location: <%=event[i].location %></p>
	<p>Number of people needed: <%=event[i].numberOfPeople%></p>
	<p><img src="<%=event[i].img %>"></p> 
	


		 <% const index = attendIds.findIndex(userEventId => { %>
		 <% if(userEventId.toString() === event[i]._id.toString()){ %>
		 			<% return true %>
		 		<% } %>
		 	<% })%>
		 	
		 	<% if(index === -1){ %>
		 		<!--conditional based on value of variable index (index will be negative one if no match in attendIds -->
		 		<a href="/users/attend/<%=event[i]._id%>">participate</a>
			<% } %> 	
	</div>
<%}%>

	<%- include ../partials/footer.ejs %>